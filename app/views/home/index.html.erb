<div class="home-container">
  <h2 class="section-title">Escanear QR Code</h2>

  <div id="qr-reader" style="width: 100%; max-width: 400px; margin: 20px auto;"></div>
  <div id="qr-result" class="qr-result"></div>
</div>

<script src="https://unpkg.com/html5-qrcode"></script>
<script>
  function onScanSuccess(decodedText, decodedResult) {
    // CPF lido do QR Code
    let cpf = decodedText.trim();

    // Redireciona para ações new com CPF
    window.location.href = "/acoes/new?cpf=" + encodeURIComponent(cpf);
  }

  function onScanError(errorMessage) {
    console.log("Erro ao ler QRCode:", errorMessage);
  }

  // Inicializa o leitor
  document.addEventListener("DOMContentLoaded", function() {
    let qrCodeScanner = new Html5QrcodeScanner(
      "qr-reader",
      { fps: 10, qrbox: 250 }
    );
    qrCodeScanner.render(onScanSuccess, onScanError);
  });
</script>
